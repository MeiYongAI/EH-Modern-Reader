# 纵向连续模式快速入门

## 什么是纵向连续模式？

纵向连续模式允许你像阅读长图一样，通过上下滚动浏览整个画廊的所有页面。

## 与其他模式的对比

| 特性 | 单页模式 | 横向连续 | 纵向连续 |
|-----|---------|---------|---------|
| **浏览方式** | 一次一页 | 左右滚动 | 上下滚动 |
| **翻页按钮** | 左右箭头 | 点击左右区域 | 点击上下区域 |
| **适合场景** | 精细查看 | 宽屏显示器 | 手机/竖屏 |
| **滚轮行为** | 翻页 | 横向滚动 | 纵向滚动 |

## 如何启用？

### 方法 1：设置面板
1. 打开 MPV 页面（`/mpv/` URL）
2. 点击右上角 ⚙️ 设置按钮
3. 找到"阅读模式"
4. 选择 ○ 纵向连续

### 方法 2：键盘快捷键（计划中）
- 暂未实现，敬请期待

## 基本操作

### 浏览
- **鼠标滚轮**：上下滚动
- **触控板**：双指上下滑动
- **点击区域**：
  - 上部 1/3：上一页
  - 中部 1/3：显示/隐藏菜单栏
  - 下部 1/3：下一页

### 翻页
- **键盘**：↑/↓ 或 W/S 键
- **Home**：跳到第一页
- **End**：跳到最后一页

### 缩略图
- 点击底部缩略图可直接跳转到对应页面
- 当前页面的缩略图会自动高亮

## 高级功能

### 反向阅读
1. 打开设置面板
2. 勾选"反向阅读"
3. 画面会垂直翻转（从下往上阅读）
4. 点击区域也会反转（上部变下一页，下部变上一页）

### 自动播放
- 点击底部 ▶️ 按钮或按 P 键
- 自动按设定间隔向下滚动
- 再次点击或按 P 暂停

### 全屏模式
- 按 F11 进入全屏
- 按 Esc 退出全屏

## 性能提示

### 加载速度
- 图片会按需加载（懒加载）
- 视口附近 ±1200px 的图片会提前预加载
- 滚动时会优先加载视口中心的图片

### 节省流量
- 只有进入视口的图片才会加载
- 已加载的图片会缓存 24 小时
- 切换模式时会复用缓存，不会重新下载

### 避免限流
- 默认配置已优化（3 并发 + 250ms 间隔）
- 避免快速大幅跳页（如从第 1 页跳到第 100 页）
- 若看到"Excessive request rate"错误，暂停操作 30 秒

## 常见问题

### Q: 图片加载慢怎么办？
A: 检查网络连接；E-Hentai 服务器速度因地区而异；可以暂停滚动等待当前图片加载完成。

### Q: 切换模式后位置不对？
A: 系统会自动滚动到当前页面，若未生效可手动点击缩略图跳转。

### Q: 反向阅读和纵向模式冲突吗？
A: 不冲突，反向阅读会让画面垂直翻转，适合从下往上的阅读习惯。

### Q: 可以调整图片间距吗？
A: 当前版本固定为 8px，未来版本计划支持自定义。

### Q: 触控设备支持如何？
A: 基本支持触控滑动，但可能与浏览器手势冲突（如下拉刷新）。

## 技术细节（开发者）

### DOM 结构
```html
<div id="eh-continuous-vertical">
  <div class="eh-cv-card">
    <div class="eh-cv-wrapper">
      <img data-page-index="0">
    </div>
  </div>
  <!-- 重复 pageCount 次 -->
</div>
```

### 观察器配置
```javascript
new IntersectionObserver(callback, {
  root: container,
  rootMargin: '1200px',  // 提前预加载
  threshold: 0.01
});
```

### 滚动定位算法
1. 计算所有前置图片的累计高度
2. 加上容器的上内边距（12px）
3. 减去居中偏移量
4. 设置 `scrollTop` 到计算值

## 反馈与建议

欢迎在 GitHub Issues 提交：
- Bug 报告
- 功能建议
- 使用体验反馈

项目地址：`https://github.com/MeiYongAI/EH-Modern-Reader`
